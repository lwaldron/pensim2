<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Parallelized calculation of cross-validated risk score
  predictions from L1/L2/Elastic Net penalized regression. — opt.nested.crossval • pensim</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Parallelized calculation of cross-validated risk score
  predictions from L1/L2/Elastic Net penalized regression. — opt.nested.crossval" />
<meta property="og:description" content="calculates risk score predictions by a nested cross-validation, using
  the optL1 and optL2 functions of the penalized R package for
  regression.  In the outer level of cross-validation, samples are split
  into training and test samples.  Model parameters are tuned by cross-validation within
  training samples only.
By setting nprocessors &amp;gt; 1, the outer cross-validation is split between multiple processors.
The functions support z-score scaling of training data, and application
  of these scaling and shifting coefficients to the test data.  It also
  supports repeated tuning of the penalty parameters and selection of the
  model with greatest cross-validated likelihood." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pensim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pensim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/waldronlab/pensim/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parallelized calculation of cross-validated risk score
  predictions from L1/L2/Elastic Net penalized regression.</h1>
    
    <div class="hidden name"><code>opt.nested.crossval.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>calculates risk score predictions by a nested cross-validation, using
  the optL1 and optL2 functions of the penalized R package for
  regression.  In the outer level of cross-validation, samples are split
  into training and test samples.  Model parameters are tuned by cross-validation within
  training samples only.</p>
<p>By setting nprocessors &gt; 1, the outer cross-validation is split between multiple processors.</p>
<p>The functions support z-score scaling of training data, and application
  of these scaling and shifting coefficients to the test data.  It also
  supports repeated tuning of the penalty parameters and selection of the
  model with greatest cross-validated likelihood.</p>
    </div>

    <pre class="usage"><span class='fu'>opt.nested.crossval</span>(<span class='kw'>outerfold</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>nprocessors</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>cl</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>outerfold</th>
      <td><p>number of folds in outer cross-validation (the level used for validation)</p></td>
    </tr>
    <tr>
      <th>nprocessors</th>
      <td><p>An integer number of processors to use.  If specified in 
    opt.nested.crossval, iterations of the outer cross-validation are
    sent to different processors.  If specified in opt.splitval,
    repeated starts for the penalty tuning are sent to different processors.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>Optional cluster object created with the makeCluster() function of
    the parallel package.  If this is not set, pensim calls
    makeCluster(nprocessors, type="SOCK").   Setting this parameter
    can enable parallelization in more diverse scenarios than multi-core
    desktops; see the documentation for the parallel package.  Note that if
    cl is user-defined, this function will not automatically run
    parallel::stopCluster() to shut down the cluster.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>optFUN (either "opt1D" or "opt2D"), scaling (TRUE to z-score
    training data then apply the same shift and scale factors to test
    data, FALSE for no scaling) are passed onto the opt.splitval
    function.  Additional arguments are required, to be passed to the
    optL1 or optL2 function of the penalized R package.  See those help
    pages, and it may be desirable to test these arguments directly on
    optL1 or optL2 before using this more CPU-consuming and complex
    function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function calculates cross-validated risk score predictions,
  tuning a penalized regression model using the optL1 or optL2 functions
  of the penalized R package, for each iteration of the
  cross-validation.  Tuning is done by cross-validation in the training
  samples only.  Test samples are scaled using the shift and scale
  factors determined from the training samples.  parameter.  If
  nprocessors &gt; 1, it uses the SNOW package for parallelization,
  dividing the iterations of the outer cross-validation among the
  specified number of processors.</p>
<p>Some arguments MUST be passed (through the ... arguments) but which
  are documented for the functions in which they are used.  These
  include, from the opt.splitval function:</p>  
<p>optFUN="opt1D" for Lasso or Ridge regression, or "opt2D" for Elastic
  Net.  See the help pages for opt1D and opt2D for additional
  arguments associated with these functions.</p>    
<p>scaling=TRUE to scale each feature (column) of the training sample to
  z-scores.  These same scaling and shifting factors are applied to the
  test data.  If FALSE, no scaling is done.  Note that only data in the
  penalized argument are scaled, not the optional unpenalized argument
  (see documentation for opt1D, opt2D, or cvl from the penalized package
  for descriptions of the penalized and unpenalized arguments).
  Alternatively, the standardize=TRUE argument to the penalized package
  functions can be used to do scaling internally.</p>
<p>nsim=50 this number specifies the number of times to repeat tuning of
  the penalty parameters on different data foldings for the
  cross-validation.</p>
<p>setpen="L1" or "L2" : if optFUN="opt1D", this sets regression type to
  LASSO or Ridge, respectively.  See ?opt1D.</p>
<p>L1range, L2range, dofirst, L1gridsize, L2gridsize: options for Elastic
  Net regression if optFUN="opt2D".  See ?opt2D.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a vector of cross-validated continuous risk score predictions.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Waldron L, Pintilie M, Tsao M-S, Shepherd FA, Huttenhower C*, Jurisica
  I*: Optimized application of penalized regression methods to diverse
  genomic data. Bioinformatics 2011, 27:3399-3406.  (*equal contribution)</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Depends on the R packages: penalized, parallel</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>opt.splitval</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>beer.exprs</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>beer.survival</span>)

<span class='co'>##select just 100 genes to speed computation:</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='no'>beer.exprs.sample</span> <span class='kw'>&lt;-</span> <span class='no'>beer.exprs</span>[<span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>beer.exprs</span>), <span class='fl'>100</span>), ]

<span class='no'>gene.quant</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>beer.exprs.sample</span>, <span class='fl'>1</span>, <span class='no'>quantile</span>, <span class='kw'>probs</span> <span class='kw'>=</span> <span class='fl'>0.75</span>)
<span class='no'>dat.filt</span> <span class='kw'>&lt;-</span> <span class='no'>beer.exprs.sample</span>[<span class='no'>gene.quant</span> <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span>(<span class='fl'>100</span>), ]
<span class='no'>gene.iqr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>dat.filt</span>, <span class='fl'>1</span>, <span class='no'>IQR</span>)
<span class='no'>dat.filt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>dat.filt</span>[<span class='no'>gene.iqr</span> <span class='kw'>&gt;</span> <span class='fl'>0.5</span>, ])
<span class='no'>dat.filt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>dat.filt</span>)
<span class='no'>dat.filt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>dat.filt</span>)

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>survival</span>)
<span class='no'>surv.obj</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/Surv.html'>Surv</a></span>(<span class='no'>beer.survival</span>$<span class='no'>os</span>, <span class='no'>beer.survival</span>$<span class='no'>status</span>)

<span class='co'>## First, test the regression arguments using functions from</span>
<span class='co'>## the penalized package.  I use maxlambda1=5 here to ensure at least</span>
<span class='co'>## one non-zero coefficient.</span>
<span class='no'>testfit</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>penalized</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/penalized/man/cvl.html'>optL1</a></span>(
  <span class='kw'>response</span> <span class='kw'>=</span> <span class='no'>surv.obj</span>,
  <span class='kw'>maxlambda1</span> <span class='kw'>=</span> <span class='fl'>3</span>,
  <span class='kw'>penalized</span> <span class='kw'>=</span> <span class='no'>dat.filt</span>,
  <span class='kw'>fold</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>positive</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='output co'>#&gt; lambda= 1.145898 	12cvl= -127.4981 
#&gt; lambda= 1.854102 	12cvl= -120.1576 
#&gt; lambda= 2.291796 	12cvl= -117.5577 
#&gt; lambda= 2.841986 	12cvl= -115.7448 
#&gt; lambda= 2.631832 	12cvl= -116.3155 
#&gt; lambda= 2.761715 	12cvl= -115.9482 
#&gt; lambda= 2.902342 	12cvl= -115.6034 
#&gt; lambda= 2.939644 	12cvl= -115.5208 
#&gt; lambda= 2.962698 	12cvl= -115.4716 
#&gt; lambda= 2.976946 	12cvl= -115.4419 
#&gt; lambda= 2.985752 	12cvl= -115.4238 
#&gt; lambda= 2.991194 	12cvl= -115.4127 
#&gt; lambda= 2.994558 	12cvl= -115.4059 
#&gt; lambda= 2.996636 	12cvl= -115.4017 
#&gt; lambda= 2.997921 	12cvl= -115.3991 
#&gt; lambda= 2.998715 	12cvl= -115.3975 
#&gt; lambda= 2.999206 	12cvl= -115.3966 
#&gt; lambda= 2.999509 	12cvl= -115.3961 </div><div class='input'>
<span class='co'>## Now pass these arguments to opt.nested.splitval() for cross-validated</span>
<span class='co'>## calculation and assessment of risk scores, with the additional</span>
<span class='co'>## arguments:</span>
<span class='co'>##    outerfold and nprocessors (?opt.nested.crossval)</span>
<span class='co'>##    optFUN and scaling (?opt.splitval)</span>
<span class='co'>##    setpen and nsim (?opt1D)</span>

<span class='co'>## Ideally nsim would be 50, and outerfold and fold would be 10, but the</span>
<span class='co'>## values below speed computation 200x compared to these recommended</span>
<span class='co'>## values.  Note that here we are using the standardize=TRUE argument of</span>
<span class='co'>## optL1 rather than the scaling=TRUE argument of opt.splitval.  These</span>
<span class='co'>## two approaches to scaling are roughly equivalent, but the scaling</span>
<span class='co'>## approaches are not the same (scaling=TRUE does z-score,</span>
<span class='co'>## standardize=TRUE scales to unit central L2 norm), and results will</span>
<span class='co'>## not be identical.  Also, using standardize=TRUE scales variables but</span>
<span class='co'>## provides coeffients for the original scale, whereas using</span>
<span class='co'>## scaling=TRUE scales variables in the training set then applies the</span>
<span class='co'>## same scales to the test set.</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1</span>)
<span class='co'>## In this example I use two processors:</span>
<span class='no'>preds</span> <span class='kw'>&lt;-</span>
  <span class='kw pkg'>pensim</span><span class='kw ns'>::</span><span class='fu'>opt.nested.crossval</span>(
    <span class='kw'>outerfold</span> <span class='kw'>=</span> <span class='fl'>2</span>,
    <span class='kw'>nprocessors</span> <span class='kw'>=</span> <span class='fl'>1</span>,
    <span class='co'>#opt.nested.crossval arguments</span>
    <span class='kw'>optFUN</span> <span class='kw'>=</span> <span class='st'>"opt1D"</span>,
    <span class='kw'>scaling</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='co'>#opt.splitval arguments</span>
    <span class='kw'>setpen</span> <span class='kw'>=</span> <span class='st'>"L1"</span>,
    <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>1</span>,
    <span class='co'>#opt1D arguments</span>
    <span class='kw'>response</span> <span class='kw'>=</span> <span class='no'>surv.obj</span>,
    <span class='co'>#rest are penalized::optl1 arguments</span>
    <span class='kw'>penalized</span> <span class='kw'>=</span> <span class='no'>dat.filt</span>,
    <span class='kw'>fold</span> <span class='kw'>=</span> <span class='fl'>2</span>,
    <span class='kw'>maxlambda1</span> <span class='kw'>=</span> <span class='fl'>5</span>,
    <span class='kw'>positive</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
  )

<span class='co'>## We probably also want the coefficients from the model fit on all the</span>
<span class='co'>## data, for future use:</span>
<span class='no'>beer.coefs</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>pensim</span><span class='kw ns'>::</span><span class='fu'><a href='opt1D.html'>opt1D</a></span>(
  <span class='kw'>setpen</span> <span class='kw'>=</span> <span class='st'>"L1"</span>,
  <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>maxlambda1</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>response</span> <span class='kw'>=</span> <span class='no'>surv.obj</span>,
  <span class='kw'>penalized</span> <span class='kw'>=</span> <span class='no'>dat.filt</span>,
  <span class='kw'>fold</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>positive</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='co'>## We can also include unpenalized covariates, if desired.</span>
<span class='co'>## Note that when keeping only one variable for a penalized or</span>
<span class='co'>## unpenalized covariate, indexing a dataframe like [1] instead of doing</span>
<span class='co'>## [,1] preserves the variable name.  With [,1] the variable name gets</span>
<span class='co'>## converted to "".</span>

<span class='no'>beer.coefs</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>pensim</span><span class='kw ns'>::</span><span class='fu'><a href='opt1D.html'>opt1D</a></span>(
  <span class='kw'>setpen</span> <span class='kw'>=</span> <span class='st'>"L1"</span>,
  <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>maxlambda1</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>response</span> <span class='kw'>=</span> <span class='no'>surv.obj</span>,
  <span class='kw'>penalized</span> <span class='kw'>=</span> <span class='no'>dat.filt</span>[-<span class='fl'>1</span>],
  <span class='co'># This is equivalent to dat.filt[, -1]</span>
  <span class='kw'>unpenalized</span> <span class='kw'>=</span> <span class='no'>dat.filt</span>[<span class='fl'>1</span>],
  <span class='kw'>fold</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>positive</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)
<span class='co'>## (note the non-zero first coefficient this time, due to it being unpenalized).</span>

<span class='co'>## Summarization and plotting.</span>
<span class='no'>preds.dichot</span> <span class='kw'>&lt;-</span> <span class='no'>preds</span> <span class='kw'>&gt;</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span>(<span class='no'>preds</span>)

<span class='no'>coxfit.continuous</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/coxph.html'>coxph</a></span>(<span class='no'>surv.obj</span> ~ <span class='no'>preds</span>)
<span class='no'>coxfit.dichot</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/survival/man/coxph.html'>coxph</a></span>(<span class='no'>surv.obj</span> ~ <span class='no'>preds.dichot</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>coxfit.continuous</span>)</div><div class='output co'>#&gt; Call:
#&gt; coxph(formula = surv.obj ~ preds)
#&gt; 
#&gt;   n= 86, number of events= 24 
#&gt; 
#&gt;         coef exp(coef) se(coef)     z Pr(&gt;|z|)   
#&gt; preds 1.1001    3.0044   0.3964 2.775  0.00552 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt;       exp(coef) exp(-coef) lower .95 upper .95
#&gt; preds     3.004     0.3328     1.382     6.534
#&gt; 
#&gt; Concordance= 0.713  (se = 0.058 )
#&gt; Likelihood ratio test= 8.52  on 1 df,   p=0.004
#&gt; Wald test            = 7.7  on 1 df,   p=0.006
#&gt; Score (logrank) test = 8.49  on 1 df,   p=0.004
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>coxfit.dichot</span>)</div><div class='output co'>#&gt; Call:
#&gt; coxph(formula = surv.obj ~ preds.dichot)
#&gt; 
#&gt;   n= 86, number of events= 24 
#&gt; 
#&gt;                    coef exp(coef) se(coef)     z Pr(&gt;|z|)  
#&gt; preds.dichotTRUE 0.9573    2.6046   0.4341 2.205   0.0275 *
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt;                  exp(coef) exp(-coef) lower .95 upper .95
#&gt; preds.dichotTRUE     2.605     0.3839     1.112     6.099
#&gt; 
#&gt; Concordance= 0.633  (se = 0.049 )
#&gt; Likelihood ratio test= 5.22  on 1 df,   p=0.02
#&gt; Wald test            = 4.86  on 1 df,   p=0.03
#&gt; Score (logrank) test = 5.24  on 1 df,   p=0.02
#&gt; </div><div class='input'>
<span class='no'>nobs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>preds</span>)
<span class='no'>cutoff</span> <span class='kw'>&lt;-</span> <span class='fl'>12</span>
<span class='no'>preds.roc</span> <span class='kw'>&lt;-</span>
  <span class='kw pkg'>survivalROC</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/survivalROC/man/survivalROC.html'>survivalROC</a></span>(
    <span class='kw'>Stime</span> <span class='kw'>=</span> <span class='no'>beer.survival</span>$<span class='no'>os</span>,
    <span class='kw'>status</span> <span class='kw'>=</span> <span class='no'>beer.survival</span>$<span class='no'>status</span>,
    <span class='kw'>marker</span> <span class='kw'>=</span> <span class='no'>preds</span>,
    <span class='kw'>predict.time</span> <span class='kw'>=</span> <span class='no'>cutoff</span>,
    <span class='kw'>span</span> <span class='kw'>=</span> <span class='fl'>0.25</span> * <span class='no'>nobs</span> ^ (-<span class='fl'>0.20</span>)
  )
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(
  <span class='no'>preds.roc</span>$<span class='no'>FP</span>,
  <span class='no'>preds.roc</span>$<span class='no'>TP</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"l"</span>,
  <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>),
  <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>),
  <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"FP"</span>, <span class='st'>"\n"</span>, <span class='st'>"AUC = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>preds.roc</span>$<span class='no'>AUC</span>, <span class='fl'>3</span>)),
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"TP"</span>,
  <span class='kw'>main</span> <span class='kw'>=</span> <span class='st'>"LASSO predictions\n ROC curve at 12 months"</span>
)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(<span class='fl'>0</span>, <span class='fl'>1</span>)</div><div class='img'><img src='opt.nested.crossval-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Waldron, Levi, Pintilie, Melania, Tsao, {Ming-Sound}, Shepherd, Frances A, Huttenhower, Curtis, Jurisica, Igor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


